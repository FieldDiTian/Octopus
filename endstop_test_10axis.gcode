; ===================================================================
; Endstop 限位开关测试 - 10轴系统
; 测试所有轴的限位开关功能
; ===================================================================

M117 Endstop test starting
G21 ; 毫米单位
G90 ; 绝对坐标

; 警告: 确保所有轴都有足够空间移动，避免碰撞!

; === M119 - 查看当前限位开关状态 ===
M117 Current endstop status
M119  ; 显示所有限位开关状态

G4 P5000  ; 等待5秒查看状态

; === 单轴归位测试 ===
; 注意: 只有安装了限位开关的轴才能归位

M117 Testing X endstop
G28 X  ; X轴归位
G4 P2000

M117 Testing Y endstop  
G28 Y  ; Y轴归位
G4 P2000

M117 Testing Z endstop
G28 Z  ; Z轴归位
G4 P2000

; 额外轴归位测试 (如果安装了限位开关)
M117 Testing additional axes
; 注意: 以下命令仅在安装相应限位开关时有效

; G28 U  ; U轴归位 - 需要连接限位开关到PA4
; G4 P2000

; G28 V  ; V轴归位 - 需要连接限位开关到PA5
; G4 P2000

; G28 W  ; W轴归位 - 需要连接限位开关到PA6
; G4 P2000

; G28 I  ; I轴归位 - 需要连接限位开关到PA1
; G4 P2000

; G28 J  ; J轴归位 - 需要连接限位开关到PA2
; G4 P2000

; G28 K  ; K轴归位 - 需要连接限位开关到PA3
; G4 P2000

; === 全轴归位测试 ===
M117 All axes homing
G28    ; 所有轴归位 (仅限已安装限位开关的轴)
G4 P3000

; === 限位开关状态再次检查 ===
M117 Final endstop check
M119   ; 显示归位后的限位开关状态
G4 P3000

; === 离开限位开关测试 ===
M117 Moving away from endstops
G1 X10 Y10 Z5 F1200  ; 从限位开关移开
G4 P2000

M117 Endstop test complete
M84  ; 关闭电机

; ===================================================================
; 限位开关引脚分配:
; X_MIN_PIN: 已定义 (PF0 - X_DIAG_PIN)
; Y_MIN_PIN: 已定义 (PF2 - Y_DIAG_PIN)  
; Z_MIN_PIN: 已定义 (PF4 - Z_DIAG_PIN)
; U_MIN_PIN: PA4 (新增)
; V_MIN_PIN: PA5 (新增)
; W_MIN_PIN: PA6 (新增)
; I_MIN_PIN: PA1 (新增)
; J_MIN_PIN: PA2 (新增)
; K_MIN_PIN: PA3 (新增)
;
; 连接说明:
; 1. 将限位开关连接到对应的GPIO引脚
; 2. 确保限位开关为常开(NO)类型
; 3. 在触发时开关应该闭合
; 4. 使用M119命令验证开关状态
;
; 故障排除:
; - 如果M119显示"open"，限位开关未触发
; - 如果M119显示"TRIGGERED"，限位开关已触发
; - 归位失败可能是限位开关未连接或配置错误
; ===================================================================